<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M贸dulo 4 | Java Funcional Elite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], },
                    animation: { 'fade-in-up': 'fadeInUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards', },
                    keyframes: { fadeInUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' }, }, }
                }
            }
        }
    </script>
</head>

<body
    class="flex flex-col h-screen bg-slate-50 text-slate-800 antialiased selection:bg-orange-500 selection:text-white overflow-hidden">

    <nav
        class="fixed w-full z-50 bg-slate-900/95 backdrop-blur-md border-b border-slate-700/50 text-white h-16 flex items-center justify-between px-6 shadow-lg">
        <div class="flex items-center gap-4">
            <a href="../index.html"
                class="group flex items-center gap-2 text-slate-300 hover:text-white transition-all bg-white/5 hover:bg-white/10 px-4 py-2 rounded-lg border border-white/10 hover:border-white/20">
                <i class="fas fa-arrow-left text-sm group-hover:-translate-x-1 transition-transform"></i>
                <span class="text-sm font-medium">Dashboard</span>
            </a>
            <div class="h-6 w-px bg-slate-700 mx-2"></div>
            <div class="flex items-center gap-3">
                <div class="bg-orange-600/20 p-2 rounded-lg border border-orange-500/30 text-orange-400">
                    <i class="fas fa-filter text-lg"></i>
                </div>
                <div>
                    <h1 class="font-bold text-sm tracking-wide leading-none">M贸dulo 04</h1>
                    <span class="text-xs text-slate-400 font-medium">Paradigma Funcional</span>
                </div>
            </div>
        </div>
        <div class="hidden md:flex items-center gap-4">
            <div class="flex items-center gap-2 px-3 py-1.5 bg-orange-900/30 rounded-full border border-orange-500/20">
                <span class="relative flex h-2 w-2">
                    <span
                        class="animate-ping absolute inline-flex h-full w-full rounded-full bg-orange-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 bg-orange-500"></span>
                </span>
                <span class="text-xs font-semibold text-orange-300">Java 21 LTS</span>
            </div>
        </div>
    </nav>

    <div class="flex flex-1 pt-16 h-full overflow-hidden">
        <aside class="w-80 bg-white border-r border-slate-200 shadow-xl z-20 hidden md:flex flex-col">
            <div class="p-6 border-b border-slate-100 bg-slate-50/50">
                <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-1">Plan de Estudio</h3>
                <p class="text-sm text-slate-600 font-medium">4 Lecciones Avanzadas</p>
            </div>
            <div class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-2">
                <button onclick="showLesson(16)" id="btn-16"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden active">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">16</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Lambdas Internals</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-orange-500 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(17)" id="btn-17"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">17</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Stream API Architecture</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-orange-500 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(18)" id="btn-18"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">18</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Optional & Monads</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-orange-500 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(19)" id="btn-19"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">19</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Time API (Thread-Safe)</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-orange-500 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
            </div>
        </aside>

        <main class="flex-1 overflow-y-auto relative bg-slate-50 scroll-smooth">
            <div class="max-w-5xl mx-auto px-8 py-12 relative z-10">

                <div id="lesson-16" class="lesson-section active animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-orange-100 text-orange-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                16</span>
                            <span class="text-slate-400 text-sm font-medium"><i class="far fa-clock mr-1"></i> 30
                                min</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Internals de
                            Lambdas: Bytecode & Invokedynamic</h1>
                    </div>

                    <div
                        class="bg-white rounded-2xl p-8 shadow-lg shadow-orange-900/5 border-l-4 border-orange-500 mb-10">
                        <h3 class="!mt-0 text-xl font-bold text-slate-800 mb-4 flex items-center gap-2"><i
                                class="fas fa-bullseye text-orange-600"></i> Objetivos Senior</h3>
                        <ul class="list-disc list-inside text-slate-600 text-sm space-y-2">
                            <li>Diferencia cr铆tica entre Clases An贸nimas y Lambdas (Memoria/Disco).</li>
                            <li>La instrucci贸n <code>invokedynamic</code> y el <code>LambdaMetafactory</code>.</li>
                            <li>Interfaces Funcionales (JLS 搂9.8): <code>Predicate</code>, <code>Function</code>,
                                <code>Consumer</code>.</li>
                        </ul>
                    </div>

                    <h2>1. No es "Syntactic Sugar": La instrucci贸n Invokedynamic</h2>
                    <p class="text-slate-600 mb-6">Muchos desarrolladores creen que las Lambdas son simplemente una
                        forma corta de escribir Clases An贸nimas. <strong>Incorrecto.</strong></p>

                    <p class="text-slate-600 mb-6">Una Clase An贸nima (ej: <code>new Runnable...</code>) genera un
                        archivo f铆sico <code>.class</code> en disco (ej: <code>Main$1.class</code>) y carga una clase
                        completa en el Metaspace. Las Lambdas, en cambio, utilizan la instrucci贸n de bytecode
                        <strong><code>invokedynamic</code></strong> (introducida en Java 7, explotada en Java 8).</p>

                    <p class="text-slate-600 mb-6">En tiempo de ejecuci贸n, la JVM llama al
                        <strong>LambdaMetafactory</strong>, que genera la implementaci贸n de la interfaz funcional "al
                        vuelo", optimizando el uso de memoria y evitando la carga de clases innecesarias.</p>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">2. El Kit de Herramientas
                        (java.util.function)</h3>
                    <p class="text-slate-600 mb-4">La JLS define una <strong>Functional Interface</strong> como una
                        interfaz con <strong>exactamente un m茅todo abstracto</strong>. El paquete
                        <code>java.util.function</code> cubre el 90% de los casos de uso:</p>

                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                            <code class="font-bold text-blue-700">Predicate&lt;T&gt;</code>
                            <p class="text-xs mt-1 text-slate-600"><code>boolean test(T t)</code>. Eval煤a condiciones.
                            </p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-xl border border-green-100">
                            <code class="font-bold text-green-700">Function&lt;T, R&gt;</code>
                            <p class="text-xs mt-1 text-slate-600"><code>R apply(T t)</code>. Transforma datos.</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-xl border border-purple-100">
                            <code class="font-bold text-purple-700">Consumer&lt;T&gt;</code>
                            <p class="text-xs mt-1 text-slate-600"><code>void accept(T t)</code>. Ejecuta efectos
                                secundarios (side-effects).</p>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-100">
                            <code class="font-bold text-yellow-700">Supplier&lt;T&gt;</code>
                            <p class="text-xs mt-1 text-slate-600"><code>T get()</code>. Generaci贸n perezosa (Lazy
                                loading).</p>
                        </div>
                    </div>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-orange-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Refactorizaci贸n a Lambda</h4>
                        <p class="text-sm text-slate-600 mb-4">Toma el siguiente c贸digo legacy y convi茅rtelo a una
                            expresi贸n Lambda. Observa c贸mo el IDE sugiere autom谩ticamente la reducci贸n.</p>
                        <code
                            class="text-xs block bg-white p-2 rounded mb-2">Runnable r = new Runnable() { public void run() { System.out.println("Run"); } };</code>
                        <details class="text-xs text-slate-500 cursor-pointer">
                            <summary>Ver Soluci贸n</summary><code>Runnable r = () -> System.out.println("Run");</code>
                        </details>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Method References (::)</h4>
                        <p class="text-sm text-slate-600 mb-4">Utiliza la referencia a m茅todos para simplificar una
                            lambda. Ordena una lista de Strings ignorando may煤sculas/min煤sculas usando
                            <code>String::compareToIgnoreCase</code>.</p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Dise帽o de APIs Funcionales</h4>
                        <p class="text-sm text-slate-400 mb-4">Crea tu propia Interfaz Funcional
                            <code>TriFunction&lt;A,B,C,R&gt;</code> que acepte 3 argumentos. Implementa un m茅todo que la
                            use para componer l贸gica de negocio compleja.</p>
                        <button onclick="toggleSolution('sol-16')"
                            class="text-xs bg-orange-600 hover:bg-orange-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-16" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">@FunctionalInterface // Asegura que solo tenga 1 m茅todo abstracto
interface TriFunction&lt;A, B, C, R&gt; {
    R apply(A a, B b, C c);
}

// Uso
TriFunction&lt;Integer, Integer, Integer, Integer&gt; suma = (x, y, z) -> x + y + z;
int total = suma.apply(10, 20, 30); // 60</code></pre>
                        </div>
                    </div>

                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-6">Quiz de Validaci贸n</h3>
                        <div class="space-y-4">
                            <div>
                                <p class="text-sm font-semibold mb-2">1. 驴Qu茅 instrucci贸n de bytecode utilizan
                                    principalmente las Lambdas?</p>
                                <div class="grid grid-cols-2 gap-2">
                                    <button class="quiz-btn border p-2 rounded text-sm hover:bg-slate-50"
                                        onclick="checkQuiz(this, true)">invokedynamic</button>
                                    <button class="quiz-btn border p-2 rounded text-sm hover:bg-slate-50"
                                        onclick="checkQuiz(this, false)">invokevirtual</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="lesson-17" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-orange-100 text-orange-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                17</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Stream API:
                            Pipelines y Evaluaci贸n Perezosa</h1>
                    </div>

                    <div
                        class="bg-white rounded-2xl p-8 shadow-lg shadow-orange-900/5 border-l-4 border-orange-500 mb-10">
                        <p class="text-slate-600">Un Stream <strong>NO es una estructura de datos</strong>. Es una
                            abstracci贸n de un flujo de datos que permite procesamiento declarativo. No almacena
                            elementos; los transporta.</p>
                    </div>



                    <h2>1. Arquitectura del Pipeline</h2>
                    <p class="text-slate-600 mb-6">Un Stream se compone de tres partes:</p>
                    <ol class="list-decimal list-inside text-slate-600 ml-4 mb-4">
                        <li><strong>Fuente (Source):</strong> Colecci贸n, Array, I/O Channel.</li>
                        <li><strong>Operaciones Intermedias:</strong> <code>filter</code>, <code>map</code>,
                            <code>sorted</code>. Son <strong>Lazy</strong> (perezosas). Retornan un nuevo Stream.</li>
                        <li><strong>Operaci贸n Terminal:</strong> <code>collect</code>, <code>forEach</code>,
                            <code>reduce</code>. Desencadenan el procesamiento y cierran el Stream.</li>
                    </ol>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">2. Lazy Evaluation & Loop Fusion</h3>
                    <p class="text-slate-600 mb-4">Esta es la clave del rendimiento en Java 8+. Cuando encadenas
                        <code>.filter().map().sorted()</code>, la JVM no itera la lista 3 veces. Utiliza una t茅cnica
                        llamada <strong>Loop Fusion</strong> para combinar operaciones en una sola pasada (cuando es
                        posible) y solo procesa los elementos necesarios (Short-circuiting).</p>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-xl text-sm text-blue-800 mb-6">
                        <strong>Analog铆a Industrial:</strong> Una l铆nea de montaje de coches. El chasis (Stream) se
                        mueve. El robot de pintura (map) y el control de calidad (filter) est谩n en la misma l铆nea. No
                        pintas todos los coches, los guardas en un almac茅n y luego los sacas para el control de calidad.
                        Todo ocurre en flujo continuo hasta la entrega (Terminal Operation).
                    </div>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-orange-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Filtrado y Transformaci贸n</h4>
                        <p class="text-sm text-slate-600 mb-4">Dada una lista de n煤meros, usa Streams para filtrar los
                            n煤meros pares, elevarlos al cuadrado y recogerlos en una nueva lista.</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Reducci贸n (Map-Reduce)</h4>
                        <p class="text-sm text-slate-600 mb-4">Calcula el precio total de un carrito de compras. Mapea
                            los productos a sus precios (Double) y usa <code>reduce</code> o <code>sum()</code> para
                            obtener el total.</p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Collectors Complejos (GroupingBy)</h4>
                        <p class="text-sm text-slate-400 mb-4">Tienes una lista de transacciones. Agr煤palas por moneda
                            (Currency) y calcula la suma total de montos para cada moneda en un solo paso usando
                            <code>Collectors.groupingBy</code> y <code>Collectors.summingDouble</code>.</p>
                        <button onclick="toggleSolution('sol-17')"
                            class="text-xs bg-orange-600 hover:bg-orange-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-17" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">Map&lt;Currency, Double&gt; totalPorMoneda = transactions.stream()
    .collect(Collectors.groupingBy(
        Transaction::getCurrency,
        Collectors.summingDouble(Transaction::getAmount)
    ));</code></pre>
                        </div>
                    </div>
                </div>

                <div id="lesson-18" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-orange-100 text-orange-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                18</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Optional &
                            Monads: Sem谩ntica de Nulidad</h1>
                    </div>

                    <p class="text-slate-600 mb-6">El <code>null</code> es conocido como "el error del bill贸n de
                        d贸lares". <code>Optional&lt;T&gt;</code> es una implementaci贸n del patr贸n
                        <strong>M贸nada</strong>. Es un contenedor que puede o no contener un valor no nulo. Su objetivo
                        no es eliminar <code>null</code> por completo, sino forzar al desarrollador a pensar en el caso
                        "ausente" a nivel de API.</p>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">Reglas de Ingenier铆a para Optional</h3>
                    <ul class="list-disc list-inside text-slate-600 space-y-2 mb-6">
                        <li><strong>Retorno, no Estado:</strong> salo principalmente como tipo de retorno de m茅todos.
                            <strong>NO</strong> lo uses como campo de clase (no es Serializable) ni como par谩metro de
                            m茅todo (a帽ade complejidad innecesaria).</li>
                        <li><strong>Prohibido .get():</strong> Usar <code>get()</code> sin verificar
                            <code>isPresent()</code> lanza <code>NoSuchElementException</code>, lo cual es esencialmente
                            lo mismo que un <code>NullPointerException</code>. Usa <code>orElseThrow()</code>.</li>
                        <li><strong>FlatMap es tu amigo:</strong> Evita el anidamiento de chequeos ("Arrow Code") usando
                            la composici贸n mon谩dica.</li>
                    </ul>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-orange-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Recuperaci贸n Segura</h4>
                        <p class="text-sm text-slate-600 mb-4">Simula una b煤squeda en base de datos que puede devolver
                            vac铆o. Usa <code>Optional.ofNullable()</code> y provee un valor por defecto con
                            <code>orElse()</code>.</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Transformaci贸n Condicional (Map)</h4>
                        <p class="text-sm text-slate-600 mb-4">Tienes un <code>Optional&lt;String&gt;</code>. Si el
                            valor est谩 presente, p谩salo a may煤sculas y impr铆melo. Si no, no hagas nada. Usa
                            <code>map()</code> e <code>ifPresent()</code>.</p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Refactorizaci贸n con FlatMap</h4>
                        <p class="text-sm text-slate-400 mb-4">Elimina la cascada de nulos. Tienes
                            <code>User -> getAddress() -> getCity()</code>. Cada m茅todo puede devolver null. Refactoriza
                            usando <code>Optional</code> y <code>flatMap</code> para obtener la ciudad de forma segura.
                        </p>
                        <button onclick="toggleSolution('sol-18')"
                            class="text-xs bg-orange-600 hover:bg-orange-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-18" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">String ciudad = Optional.ofNullable(user)
    .flatMap(User::getAddress) // getAddress debe devolver Optional&lt;Address&gt;
    .flatMap(Address::getCity) // getCity debe devolver Optional&lt;String&gt;
    .orElse("Desconocida");</code></pre>
                        </div>
                    </div>
                </div>

                <div id="lesson-19" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-orange-100 text-orange-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                19</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Modern Date/Time
                            (JSR-310): Thread-Safety</h1>
                    </div>

                    <div class="bg-red-50 border border-red-200 rounded-xl p-6 mb-8">
                        <h3 class="font-bold text-red-800 mb-2"> Deprecated: java.util.Date</h3>
                        <p class="text-sm text-red-800">La antigua clase <code>Date</code> es <strong>mutable</strong>
                            (no thread-safe), sus meses empiezan en 0 (Enero=0) y mezcla fechas con tiempos de forma
                            confusa. Fue reemplazada en Java 8 por la API <code>java.time</code>, basada en
                            <strong>Joda-Time</strong>.</p>
                    </div>

                    <h2>1. Inmutabilidad y Thread-Safety</h2>
                    <p class="text-slate-600 mb-6">Todas las clases de <code>java.time</code> (como
                        <code>LocalDate</code>, <code>Instant</code>) son <strong>inmutables</strong>. Esto significa
                        que cualquier operaci贸n de modificaci贸n (ej: <code>plusDays(1)</code>) retorna una <strong>nueva
                            instancia</strong>, dejando la original intacta. Esto garantiza seguridad total en entornos
                        concurrentes (Multithreading).</p>

                    <div class="grid md:grid-cols-2 gap-6 mb-8 mt-6">
                        <div class="bg-slate-100 p-4 rounded-lg">
                            <h4 class="font-bold text-slate-800">Instant (Tiempo M谩quina)</h4>
                            <p class="text-sm">Representa un punto 煤nico en la l铆nea de tiempo universal (UTC), contando
                                nanosegundos desde el Epoch (1970-01-01). Ideal para logs y timestamps de backend.</p>
                        </div>
                        <div class="bg-slate-100 p-4 rounded-lg">
                            <h4 class="font-bold text-slate-800">LocalDateTime (Tiempo Humano)</h4>
                            <p class="text-sm">Representa una fecha/hora sin zona horaria ("Muro de calendario"). No
                                sirve para coordinar eventos globales, solo locales.</p>
                        </div>
                    </div>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-orange-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Aritm茅tica de Fechas</h4>
                        <p class="text-sm text-slate-600 mb-4">Obt茅n la fecha actual. Usa m茅todos fluidos para sumarle 2
                            semanas, restar 3 d铆as y formatearla a ISO-8601.</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">C谩lculo de Periodos</h4>
                        <p class="text-sm text-slate-600 mb-4">Calcula la edad exacta de una persona (a帽os, meses, d铆as)
                            dada su fecha de nacimiento usando la clase <code>Period.between()</code>.</p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Manejo de Zonas Horarias (ZonedDateTime)</h4>
                        <p class="text-sm text-slate-400 mb-4">Un servidor en "UTC" recibe una petici贸n de un usuario en
                            "America/Santiago". Convierte el <code>Instant</code> actual a la hora local del usuario
                            respetando el horario de verano (DST).</p>
                        <button onclick="toggleSolution('sol-19')"
                            class="text-xs bg-orange-600 hover:bg-orange-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-19" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">Instant ahora = Instant.now();
ZonedDateTime horaChile = ahora.atZone(ZoneId.of("America/Santiago"));
System.out.println("UTC: " + ahora);
System.out.println("Santiago: " + horaChile); // Maneja DST autom谩ticamente</code></pre>
                        </div>
                    </div>
                </div>

            </div>

            <footer class="mt-20 py-8 text-center text-slate-400 text-sm border-t border-slate-200">
                <p>&copy; 2025 Java Elite Bootcamp. Programaci贸n Funcional & APIs Modernas.</p>
            </footer>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script>
        function showLesson(id) {
            document.querySelectorAll('.lesson-section').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('active');
            });

            const selected = document.getElementById('lesson-' + id);
            selected.classList.remove('hidden');
            setTimeout(() => selected.classList.add('active'), 10);

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-orange-50', 'border-orange-100');
                btn.querySelector('.btn-indicator').classList.remove('opacity-100');
                btn.querySelector('.btn-indicator').classList.add('opacity-0');
                const icon = btn.querySelector('.btn-icon');
                icon.classList.remove('bg-orange-500', 'text-white');
                icon.classList.add('bg-slate-100', 'text-slate-500');
                btn.querySelector('.btn-text').classList.remove('text-orange-700', 'font-bold');
            });

            const activeBtn = document.getElementById('btn-' + id);
            activeBtn.classList.add('active', 'bg-orange-50', 'border-orange-100');
            activeBtn.querySelector('.btn-indicator').classList.add('opacity-100');
            activeBtn.querySelector('.btn-indicator').classList.remove('opacity-0');
            const activeIcon = activeBtn.querySelector('.btn-icon');
            activeIcon.classList.remove('bg-slate-100', 'text-slate-500');
            activeIcon.classList.add('bg-orange-500', 'text-white');
            activeBtn.querySelector('.btn-text').classList.add('text-orange-700', 'font-bold');

            document.querySelector('main').scrollTop = 0;
        }

        function toggleSolution(id) {
            const el = document.getElementById(id);
            el.classList.toggle('hidden');
        }

        function checkQuiz(btn, isCorrect) {
            const parent = btn.parentElement;
            parent.querySelectorAll('.quiz-btn').forEach(b => {
                b.classList.remove('correct', 'wrong');
            });
            if (isCorrect) {
                btn.classList.add('correct');
            } else {
                btn.classList.add('wrong');
            }
        }

        // Init
        showLesson(16);
    </script>
</body>

</html>