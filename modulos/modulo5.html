<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M贸dulo 5 | Concurrencia y Calidad Elite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../assets/syle.css">
    <script src="../assets/scriptHead.js"></script>
</head>

<body
    class="flex flex-col h-screen bg-slate-50 text-slate-800 antialiased selection:bg-red-500 selection:text-white overflow-hidden">

    <nav
        class="fixed w-full z-50 bg-slate-900/95 backdrop-blur-md border-b border-slate-700/50 text-white h-16 flex items-center justify-between px-6 shadow-lg">
        <div class="flex items-center gap-4">
            <a href="../index.html"
                class="group flex items-center gap-2 text-slate-300 hover:text-white transition-all bg-white/5 hover:bg-white/10 px-4 py-2 rounded-lg border border-white/10 hover:border-white/20">
                <i class="fas fa-arrow-left text-sm group-hover:-translate-x-1 transition-transform"></i>
                <span class="text-sm font-medium">Dashboard</span>
            </a>
            <div class="h-6 w-px bg-slate-700 mx-2"></div>
            <div class="flex items-center gap-3">
                <div class="bg-red-600/20 p-2 rounded-lg border border-red-500/30 text-red-400">
                    <i class="fas fa-microchip text-lg"></i>
                </div>
                <div>
                    <h1 class="font-bold text-sm tracking-wide leading-none">M贸dulo 05</h1>
                    <span class="text-xs text-slate-400 font-medium">Arquitectura Concurrente & Calidad</span>
                </div>
            </div>
        </div>
        <div class="hidden md:flex items-center gap-4">
            <div class="flex items-center gap-2 px-3 py-1.5 bg-red-900/30 rounded-full border border-red-500/20">
                <span class="relative flex h-2 w-2">
                    <span
                        class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
                </span>
                <span class="text-xs font-semibold text-red-300">Java 21 LTS</span>
            </div>
        </div>
    </nav>

    <div class="flex flex-1 pt-16 h-full overflow-hidden">
        <aside class="w-80 bg-white border-r border-slate-200 shadow-xl z-20 hidden md:flex flex-col">
            <div class="p-6 border-b border-slate-100 bg-slate-50/50">
                <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-1">Plan de Estudio</h3>
                <p class="text-sm text-slate-600 font-medium">5 Lecciones Cr铆ticas</p>
            </div>
            <div class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-2">
                <button onclick="showLesson(20)" id="btn-20"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden active">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">20</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Modern I/O (NIO.2)</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-red-600 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(21)" id="btn-21"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">21</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Concurrency Internals</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-red-600 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(22)" id="btn-22"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">22</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Virtual Threads (Loom)</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-red-600 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(23)" id="btn-23"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">23</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Testing Architecture</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-red-600 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
                <button onclick="showLesson(24)" id="btn-24"
                    class="nav-btn w-full text-left px-4 py-4 rounded-xl text-sm font-medium transition-all duration-200 border border-transparent hover:bg-slate-50 hover:border-slate-200 group relative overflow-hidden">
                    <div class="relative z-10 flex items-center gap-3">
                        <span
                            class="flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold group-hover:bg-white group-hover:shadow-sm transition-all btn-icon">24</span>
                        <span class="text-slate-600 group-hover:text-slate-900 btn-text">Forensics & Profiling</span>
                    </div>
                    <div
                        class="absolute left-0 top-0 bottom-0 w-1 bg-red-600 opacity-0 btn-indicator transition-opacity">
                    </div>
                </button>
            </div>
        </aside>

        <main class="flex-1 overflow-y-auto relative bg-slate-50 scroll-smooth">
            <div class="max-w-5xl mx-auto px-8 py-12 relative z-10">

                <!-- LECCIN 20 -->
                <div id="lesson-20" class="lesson-section active animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                20</span>
                            <span class="text-slate-400 text-sm font-medium"><i class="far fa-clock mr-1"></i> 35
                                min</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Modern I/O: NIO.2
                            y Manejo de Recursos</h1>
                    </div>

                    <div class="bg-white rounded-2xl p-8 shadow-lg shadow-red-900/5 border-l-4 border-red-600 mb-10">
                        <h3 class="!mt-0 text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-bullseye text-red-600"></i> Objetivos Senior
                        </h3>
                        <ul class="list-disc list-inside text-slate-600 text-sm space-y-2">
                            <li>Deprecaci贸n mental de <code>java.io.File</code>: Adopci贸n de <strong>Path & Files
                                    (NIO.2)</strong>.</li>
                            <li>Buffers Directos vs Heap Buffers: C贸mo evitar la copia de memoria en el Kernel
                                (Zero-Copy).</li>
                            <li>Streaming de archivos grandes (10GB+): Evitar <code>OutOfMemoryError</code>.</li>
                        </ul>
                    </div>

                    <h2>1. NIO.2 (New I/O 2): Abstracci贸n sobre el OS</h2>
                    <p class="text-slate-600 mb-6">El paquete <code>java.nio.file</code> (Java 7+) reemplaza al obsoleto
                        <code>java.io.File</code>. La clase <code>Path</code> es una representaci贸n abstracta, inmutable
                        y segura de una ruta en el sistema de archivos, independiente del SO (Windows/Linux).
                    </p>
                    <p class="text-slate-600 mb-6">NIO.2 interact煤a m谩s directamente con los <strong>Descriptores de
                            Archivos</strong> del Sistema Operativo, permitiendo operaciones at贸micas y manejo eficiente
                        de enlaces simb贸licos que la API antigua no pod铆a garantizar.</p>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-6 rounded-r-xl mb-8">
                        <h4 class="font-bold text-yellow-800 mb-1">隆Peligro Cr铆tico: RAM Overflow!</h4>
                        <p class="text-yellow-800 text-sm">
                            El error m谩s com煤n en producci贸n es usar <code>Files.readAllLines()</code> en archivos que
                            no controlas (logs, CSVs externos). Este m茅todo carga <strong>TODO</strong> el contenido en
                            el Heap. Si el archivo pesa 2GB y tu JVM tiene 1GB, la aplicaci贸n colapsa con
                            <code>OutOfMemoryError</code>.
                        </p>
                        <p class="text-yellow-800 text-sm font-bold mt-2">Soluci贸n: Usa Streams (Files.lines).</p>
                    </div>

                    <div class="code-window bg-[#1e1e1e] mb-8 p-4 rounded-lg overflow-x-auto">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-3 h-3 rounded-full bg-red-500"></div>
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            <span class="text-xs text-slate-400 font-mono ml-2">SmartIO.java</span>
                        </div>
                        <pre><code class="language-java">import java.nio.file.*;
import java.util.stream.Stream;

Path logFile = Path.of("var", "logs", "app.log"); // OS Agnostic Path

// Try-with-resources asegura el cierre del File Channel
// Files.lines devuelve un Stream perezoso que lee l铆nea a l铆nea
try (Stream&lt;String&gt; lines = Files.lines(logFile)) {
    lines.filter(line -> line.contains("ERROR")) // Lazy filtering
         .forEach(System.err::println);          // Procesamiento l铆nea a l铆nea
} catch (IOException e) {
    // Manejo robusto de errores de disco
}</code></pre>
                    </div>

                    <h2>2. Zero-Copy y Memory Mapped Files</h2>
                    <p class="text-slate-600 mb-4">Para aplicaciones de alto rendimiento (como Kafka o bases de datos),
                        copiar datos del disco al Kernel Space y luego al User Space (JVM Heap) es lento. NIO introduce
                        <code>FileChannel.transferTo()</code> y <code>MappedByteBuffer</code>.
                    </p>
                    <p class="text-slate-600 mb-4"><strong>MappedByteBuffer</strong> mapea una regi贸n del archivo
                        directamente a la memoria virtual del proceso. El Sistema Operativo se encarga de cargar las
                        p谩ginas de memoria desde el disco bajo demanda (Page Faults), permitiendo leer archivos de
                        Terabytes como si fueran arrays en memoria, sin ocupar Heap de Java.</p>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-red-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Atomicidad en I/O</h4>
                        <p class="text-sm text-slate-600 mb-4">Investiga <code>Files.move()</code> con la opci贸n
                            <code>StandardCopyOption.ATOMIC_MOVE</code>. Esto garantiza que el renombrado de un archivo
                            sea una operaci贸n "todo o nada" a nivel de sistema operativo, crucial para sistemas
                            transaccionales de archivos.
                        </p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Recorrido Recursivo (Walk File Tree)</h4>
                        <p class="text-sm text-slate-600 mb-4">Utiliza <code>Files.walk()</code> (que retorna un Stream)
                            para encontrar todos los archivos <code>.class</code> en tu proyecto recursivamente,
                            calculando el tama帽o total en bytes. Recuerda cerrar el Stream.</p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Memory Mapped Files Implementation</h4>
                        <p class="text-sm text-slate-400 mb-4">Implementa un lector de archivos que use
                            <code>FileChannel.map()</code>. Compara el rendimiento de leer un archivo de 1GB usando
                            <code>FileInputStream</code> vs <code>MappedByteBuffer</code>. La diferencia deber铆a ser
                            notable.
                        </p>
                        <button onclick="toggleSolution('sol-20')"
                            class="text-xs bg-red-600 hover:bg-red-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-20" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">// Mapear 1GB de archivo a memoria
try (FileChannel channel = FileChannel.open(path, StandardOpenOption.READ)) {
    MappedByteBuffer buffer = channel.map(FileChannel.MapMode.READ_ONLY, 0, channel.size());
    // Leer bytes directamente de la memoria virtual (Off-Heap)
    while(buffer.hasRemaining()) {
        byte b = buffer.get(); // Operaci贸n extremadamente r谩pida
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                        <h3 class="font-bold text-slate-800 mb-6">Quiz de Validaci贸n</h3>
                        <div class="space-y-4">
                            <div>
                                <p class="text-sm font-semibold mb-2">1. 驴Qu茅 m茅todo de Files retorna un Stream
                                    perezoso?</p>
                                <div class="grid grid-cols-2 gap-2">
                                    <button class="quiz-btn border p-2 rounded text-sm hover:bg-slate-50"
                                        onclick="checkQuiz(this, false)">readAllLines()</button>
                                    <button class="quiz-btn border p-2 rounded text-sm hover:bg-slate-50"
                                        onclick="checkQuiz(this, true)">lines()</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LECCIN 21 -->
                <div id="lesson-21" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                21</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Concurrency
                            Internals: JMM & Hardware</h1>
                    </div>

                    <div class="bg-white rounded-2xl p-8 shadow-lg shadow-red-900/5 border-l-4 border-red-600 mb-10">
                        <p class="text-slate-600">La concurrencia introduce indeterminismo. El <strong>Java Memory Model
                                (JMM)</strong> define las reglas de juego entre tu c贸digo, la JVM y el hardware (Cach茅s
                            de CPU L1/L2/L3) para garantizar consistencia.</p>
                    </div>



                    <h2>1. El Problema del Estado Compartido (Race Condition)</h2>
                    <p class="text-slate-600 mb-6">Una operaci贸n <code>count++</code> <strong>NO</strong> es at贸mica. A
                        nivel de CPU son 3 pasos distintos:
                    <ol class="list-decimal list-inside text-slate-600 mb-4 ml-4">
                        <li><strong>Read:</strong> Leer valor de memoria al registro.</li>
                        <li><strong>Modify:</strong> Incrementar registro.</li>
                        <li><strong>Write:</strong> Escribir registro a memoria.</li>
                    </ol>
                    Si dos hilos lo hacen a la vez, se produce una condici贸n de carrera donde actualizaciones se
                    pierden.</p>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">2. Visibilidad y la keyword
                        <code>volatile</code>
                    </h3>
                    <p class="text-slate-600 mb-4">Cada n煤cleo de CPU tiene su propia cach茅. Si el Hilo A modifica una
                        variable, el Hilo B (en otro n煤cleo) podr铆a estar leyendo un valor obsoleto de su propia cach茅.
                        <br><strong><code>volatile</code></strong> garantiza <strong>visibilidad</strong>: fuerza a que
                        cualquier lectura/escritura vaya directamente a la memoria principal (RAM), ignorando la cach茅
                        local para esa variable. Establece una relaci贸n "Happens-Before".
                    </p>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">3. Synchronized vs Atomics (CAS)</h3>
                    <p class="text-slate-600 mb-4">
                        <strong>Synchronized:</strong> Es un bloqueo pesimista (Monitor Lock). Fuerza al SO a detener
                        hilos (Context Switch), lo cual es costoso (miles de ciclos de CPU).
                        <br><strong>Atomics (<code>java.util.concurrent.atomic</code>):</strong> Usan instrucciones de
                        hardware optimistas llamadas <strong>CAS (Compare-And-Swap)</strong>. No bloquean el hilo; si
                        fallan (porque otro hilo modific贸 el valor), reintentan en un bucle (Spin-Lock). Son mucho m谩s
                        r谩pidos para contadores o banderas.
                    </p>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-red-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Hilos Hu茅rfanos (Daemon Threads)</h4>
                        <p class="text-sm text-slate-600 mb-4">Crea un hilo demonio (<code>setDaemon(true)</code>).
                            Demuestra que si el hilo principal termina, la JVM mata al hilo demonio instant谩neamente,
                            interrumpiendo su trabajo, a diferencia de los hilos de usuario normales.</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Simulaci贸n de Race Condition</h4>
                        <p class="text-sm text-slate-600 mb-4">Crea una clase <code>Contador</code> con un
                            <code>int count</code> simple. Lanza 1000 hilos que incrementen +1. Imprime el resultado
                            final y observa que rara vez es 1000 debido a la falta de atomicidad.
                        </p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Correcci贸n con Atomics (CAS)</h4>
                        <p class="text-sm text-slate-400 mb-4">Refactoriza el contador usando
                            <code>AtomicInteger</code>. Explica por qu茅 <code>incrementAndGet()</code> es thread-safe y
                            m谩s eficiente que sincronizar todo el m茅todo.
                        </p>
                        <button onclick="toggleSolution('sol-21')"
                            class="text-xs bg-red-600 hover:bg-red-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-21" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">public class ContadorSeguro {
    // CAS (Compare-And-Swap) optimista a nivel de CPU
    private final AtomicInteger count = new AtomicInteger(0);

    public void incrementar() {
        count.incrementAndGet(); // Thread-safe sin bloqueos pesados
    }
}</code></pre>
                        </div>
                    </div>
                </div>

                <!-- LECCIN 22 -->
                <div id="lesson-22" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                22</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Virtual Threads
                            (Project Loom): Java 21+</h1>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-xl mb-8">
                        <h3 class="font-bold text-blue-900 mb-2">Cambio de Paradigma</h3>
                        <p class="text-sm text-blue-800">Tradicionalmente, 1 Hilo Java mapeaba a 1 Hilo del Sistema
                            Operativo (OS Thread/Platform Thread). Los hilos del OS son caros (1MB stack) y limitados
                            (~5,000 hilos). Los <strong>Hilos Virtuales</strong> son entidades de la JVM, ultraligeros
                            (KB stack), permitiendo millones de hilos concurrentes.</p>
                    </div>

                    <h2>1. Modelo Thread-per-Request Renacido</h2>
                    <p class="text-slate-600 mb-6">Antes de Java 21, us谩bamos programaci贸n reactiva as铆ncrona (WebFlux,
                        Netty) para escalar, lo que complicaba el c贸digo ("Callback Hell"). Con Loom, podemos volver al
                        estilo s铆ncrono bloqueante (m谩s f谩cil de leer, debuggear y perfilar).</p>
                    <p class="text-slate-600 mb-6"><strong>Arquitectura Carrier Threads:</strong> Los Virtual Threads se
                        ejecutan "encima" de un pool peque帽o de Platform Threads (ForkJoinPool). Cuando un Virtual
                        Thread se bloquea (ej: esperando I/O de base de datos), la JVM "desmonta" su stack del hilo del
                        OS, guard谩ndolo en el Heap, y libera el hilo del OS para ejecutar otro Virtual Thread. Esto
                        maximiza el uso de CPU.</p>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-red-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Instanciaci贸n</h4>
                        <p class="text-sm text-slate-600 mb-4">Usa <code>Thread.startVirtualThread(() -> ...)</code>
                            para lanzar una tarea simple. Verifica con <code>Thread.currentThread().isVirtual()</code>
                            que realmente es virtual.</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">El Mill贸n de Hilos</h4>
                        <p class="text-sm text-slate-600 mb-4">Intenta lanzar 1 mill贸n de hilos tradicionales (Platform
                            Threads) y observa c贸mo la JVM colapsa con <code>OutOfMemoryError</code> o el OS rechaza la
                            creaci贸n. Luego haz lo mismo con Virtual Threads y sorpr茅ndete al ver que tarda segundos.
                        </p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Structured Concurrency (Preview)</h4>
                        <p class="text-sm text-slate-400 mb-4">Utiliza un <code>ExecutorService</code> virtual para
                            lanzar m煤ltiples tareas en paralelo y esperar a que todas terminen. Esto simplifica
                            dr谩sticamente la orquestaci贸n de tareas comparado con <code>CompletableFuture</code>.</p>
                        <button onclick="toggleSolution('sol-22')"
                            class="text-xs bg-red-600 hover:bg-red-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-22" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">// Un executor nuevo, ligero y desechable por cada scope
try (var executor = Executors.newVirtualThreadPerTaskExecutor()) {
    IntStream.range(0, 100_000).forEach(i -> {
        executor.submit(() -> {
            Thread.sleep(Duration.ofSeconds(1)); // Bloqueo barato, desmonta el hilo
            return i;
        });
    });
} // try-with-resources espera autom谩ticamente a que todos terminen (join)</code></pre>
                        </div>
                    </div>
                </div>

                <!-- LECCIN 23 -->
                <div id="lesson-23" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                23</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Testing
                            Profesional: Arquitectura JUnit 5</h1>
                    </div>

                    <p class="text-slate-600 mb-6">El testing no es opcional. Es la 煤nica forma de garantizar que tu
                        refactorizaci贸n no rompi贸 la l贸gica de negocio. JUnit 5 (Jupiter) es el est谩ndar de facto, con
                        una arquitectura modular (Platform + Jupiter + Vintage).</p>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">Lifecycle y Aislamiento</h3>
                    <p class="text-slate-600 mb-4">JUnit crea una <strong>nueva instancia</strong> de la clase de test
                        para cada m茅todo <code>@Test</code>. Esto garantiza aislamiento total: el estado sucio de un
                        test no afecta al siguiente.
                        <br><code>@BeforeAll</code> debe ser est谩tico porque se ejecuta antes de instanciar la clase.
                    </p>

                    <div class="code-window bg-[#1e1e1e] mb-8 p-4 rounded-lg overflow-x-auto">
                        <pre><code class="language-java">class CalculadoraTest {
    // Se ejecuta antes de CADA test. til para resetear mocks.
    @BeforeEach
    void setup() { ... }

    @Test
    @DisplayName("Suma de positivos") // Documentaci贸n viva
    void sumarPositivos() {
        // Assertions est谩ndar
        assertEquals(5, calc.sumar(2, 3), "2+3 debe ser 5");
    }
}</code></pre>
                    </div>

                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-red-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Assertions</h4>
                        <p class="text-sm text-slate-600 mb-4">Escribe un test para verificar que una lista no est茅
                            vac铆a y contenga un elemento espec铆fico. Explora <code>assertAll</code> para agrupamiento de
                            aserciones.</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Testing de Excepciones</h4>
                        <p class="text-sm text-slate-600 mb-4">Usa <code>assertThrows</code> para verificar que tu
                            c贸digo lanza la excepci贸n correcta ante inputs inv谩lidos. Es crucial testear los "caminos
                            tristes" (Sad Paths).</p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Tests Parametrizados</h4>
                        <p class="text-sm text-slate-400 mb-4">Evita duplicar c贸digo de test (Copy-Paste). Usa
                            <code>@ParameterizedTest</code> con <code>@CsvSource</code> para ejecutar la misma l贸gica de
                            prueba con m煤ltiples sets de datos (Data-Driven Testing).
                        </p>
                        <button onclick="toggleSolution('sol-23')"
                            class="text-xs bg-red-600 hover:bg-red-500 text-white px-3 py-1 rounded transition">Ver
                            Soluci贸n</button>
                        <div id="sol-23" class="hidden mt-4 pt-4 border-t border-slate-700">
                            <pre><code class="language-java">@ParameterizedTest
@CsvSource({
    "1, 1, 2",
    "2, 3, 5",
    "10, -5, 5"
})
void testSuma(int a, int b, int esperado) {
    assertEquals(esperado, calculadora.sumar(a, b));
}</code></pre>
                        </div>
                    </div>
                </div>

                <!-- LECCIN 24 -->
                <div id="lesson-24" class="lesson-section hidden animate-fade-in-up lesson-content">
                    <div class="mb-8 border-b border-slate-200 pb-6">
                        <div class="flex items-center gap-3 mb-2">
                            <span
                                class="px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold uppercase tracking-wider">Lecci贸n
                                24</span>
                        </div>
                        <h1 class="text-4xl md:text-5xl font-black text-slate-900 tracking-tight mb-4">Debugging &
                            Profiling: Diagn贸stico Forense</h1>
                    </div>

                    <div class="bg-white rounded-2xl p-8 shadow-lg shadow-red-900/5 border-l-4 border-red-600 mb-10">
                        <p class="text-slate-600">Un Senior no adivina, <strong>observa</strong>. Aprender a usar el
                            Debugger y el Profiler es m谩s valioso que aprender 10 frameworks nuevos.</p>
                    </div>

                    <h2>1. T茅cnicas de Breakpoints</h2>
                    <p class="text-slate-600 mb-6">No pongas breakpoints a lo loco. Usa <strong>Conditional
                            Breakpoints</strong>: el IDE solo detendr谩 la ejecuci贸n cuando una condici贸n espec铆fica se
                        cumpla (ej: <code>usuario.getId() == 543</code>). Esto es vital para depurar bucles masivos o
                        problemas que ocurren solo en la iteraci贸n 10,000.</p>

                    <h3 class="text-xl font-bold text-slate-800 mt-8 mb-4">2. Profiling: Encontrando Cuellos de Botella
                    </h3>
                    <p class="text-slate-600 mb-4">El Profiling (usando JVisualVM, JProfiler o herramientas integradas)
                        te permite ver en tiempo real:</p>
                    <ul class="list-disc list-inside text-slate-600 mb-6 ml-4">
                        <li><strong>CPU Sampling:</strong> Qu茅 m茅todos consumen m谩s ciclos de CPU.</li>
                        <li><strong>Memory Allocation:</strong> Qu茅 objetos est谩n llenando el Heap y qui茅n los crea.
                        </li>
                        <li><strong>Thread States:</strong> Detectar hilos bloqueados (BLOCKED) o esperando
                            indefinidamente.</li>
                    </ul>



                    <h2 class="text-slate-900 mt-12 mb-6 border-none"><i
                            class="fas fa-dumbbell text-red-600 mr-2"></i>Training Ground</h2>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-green-500">
                        <span class="text-xs font-bold text-green-600 uppercase mb-2 block"> Nivel B谩sico</span>
                        <h4 class="font-bold text-slate-800">Evaluate Expression</h4>
                        <p class="text-sm text-slate-600 mb-4">Det茅n el programa en un breakpoint. Usa la ventana
                            "Evaluate Expression" (Alt+F8) para ejecutar c贸digo arbitrario en el contexto actual (ej:
                            consultar la base de datos, cambiar el valor de una variable en memoria viva).</p>
                    </div>

                    <div class="mb-6 p-6 bg-slate-100 rounded-xl border-l-4 border-yellow-500">
                        <span class="text-xs font-bold text-yellow-600 uppercase mb-2 block"> Nivel Intermedio</span>
                        <h4 class="font-bold text-slate-800">Caza de Memory Leaks (Heap Dump)</h4>
                        <p class="text-sm text-slate-600 mb-4">Crea un programa que llene una lista est谩tica
                            <code>static List</code> infinitamente. Usa un Profiler para observar la gr谩fica "Heap
                            Memory" subir hasta que salte el <code>OutOfMemoryError</code>. Genera un <strong>Heap
                                Dump</strong> y anal铆zalo para encontrar el objeto "Dominator".
                        </p>
                    </div>

                    <div class="mb-8 p-6 bg-slate-900 rounded-xl border border-slate-700 text-white">
                        <span class="text-xs font-bold text-red-500 uppercase mb-2 block"> Nivel Avanzado</span>
                        <h4 class="font-bold text-white">Thread Dump Analysis (Deadlocks)</h4>
                        <p class="text-sm text-slate-400 mb-4">Crea un Deadlock intencional (Hilo A espera lock B, Hilo
                            B espera lock A). La aplicaci贸n se congelar谩. Genera un <strong>Thread Dump</strong> y busca
                            la secci贸n "Found one Java-level deadlock". Aprende a leer los stack traces cruzados.</p>
                    </div>
                </div>

            </div>

            <footer class="mt-20 py-8 text-center text-slate-400 text-sm border-t border-slate-200">
                <p>&copy; 2025 Java Elite Bootcamp. Arquitectura Concurrente y Calidad.</p>
            </footer>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/components/prism-java.min.js"></script>
    <script src="../assets/scriptFooter.js"></script>
</body>

</html>